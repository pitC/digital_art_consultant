!function(t){var e={};function n(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(a,i,function(e){return t[e]}.bind(null,i));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var a={inputColours:[],imgList:[],previewImgList:[],imgWhitelist:[],imgBlacklist:[],questionSet:[],answerList:[],maxQuestionCnt:100,answerIterations:0,recommendationValid:!1,checkoutImg:{image:null,screenshot:null},putInputColours:function(t){this.recommendationValid=!1,this.resetAnswers(),this.inputColours=t},putPreviewImg:function(t){this.previewImgList=[],this.previewImgList.push(t)},putCheckoutImg:function(t,e){this.checkoutImg.image=t,this.checkoutImg.screenshot=e},getCheckoutImg:function(){return this.checkoutImg},getPreviewImgList:function(){return this.previewImgList},getImgList:function(t,e){if(this.recommendationValid)e(this.imgList);else{var n={colours:t,answers:this.answerList,blacklist:this.imgBlacklist},a=[];axios.post("recommend",n).then(t=>{for(var n in this.imgList.splice(0,this.imgList.length),t.data.paletteUsed)a.push({colour:t.data.paletteUsed[n],population:null});for(var n in t.data.images){var i=t.data.images[n],s={filename:i.filename,_id:i._id,title:i.title,author:i.author,year:i.year,institution:i.institution,institutionURL:i.institutionURL,printURL:i.printURL,reason:i.recommendationReason,fileURL:i.fileURL,calclog:i.calcLog,colours:i.colours};this.imgList.push(s)}this.recommendationValid=!0,e(this.imgList,a)})}},getImgDetails:function(t,e){var n=!1;if(this.getImgList.length>0){var a=this.imgList.find(e=>e._id==t);a&&(n=!0,e(a))}if(!n){var i=`image/${t}`;axios.get(i).then(t=>{200==t.status?e(t.data):e(null)})}},resetAnswers:function(){this.answerList=[],this.questionSet=[]},getRandomQuestion:function(t){var e=this;function n(t){var n=Math.floor(Math.random()*e.questionSet.length);t(e.questionSet[n])}0==this.questionSet.length?(this.resetAnswers(),axios.get("questions").then(e=>{200==e.status?(this.questionSet=e.data,this.maxQuestionCnt=this.questionSet.length,n(t)):t(null)})):n(t)},putAnswer:function(t,e){var n={};n[t]=e,this.answerIterations++,this.answerList=[],this.answerList.push(n);var a=this.questionSet.findIndex(e=>e.id==t);this.questionSet.splice(a,1),this.recommendationValid=!1},areQuestionsLeft:function(){return this.answerIterations<this.maxQuestionCnt},putBlacklist:function(t){this.imgBlacklist.push.apply(this.imgBlacklist,t)}},i={PHOTO_INPUT:"/photo-input",COLOUR_PICKER_INPUT:"/colour-picker",RESULT_LIST:"/results",QUESTION:"/question",IMAGE_DETAILS:"/image/:id",PREVIEW:"/preview",CHECKOUT:"/checkout"};new Vue;Vue.component("calc-log-item",{template:"\n  <tr>\n    <td> <span class='badge badge-light' :style='style'>{{colour}}</span></td>\n    <td>{{scores}}</td>\n  </tr>\n  ",computed:{style(){return"background-color: "+this.colour}},props:["colour","scores"]});var s={template:'\n  \n    <div class="card text-center">\n      <img :src="fileurl" v-on:click="onPreviewRequest" alt="Card image cap" class="card-img-top img-fluid">\n      <div class="card-body">\n        <h4 class="card-title">{{title}}</h4>\n        <p class="card-text">{{author}} | {{year}}<br/><i class="fas fa-university"></i> <a :href="institutionURL" target="_blank">{{institution}}</a></p>\n        <div class="button-container">\n          <button type="button" class="btn custom-action" v-on:click="onPreviewRequest"><i class="far fa-image"></i> See it on your wall</button></button>\n        </div>\n        <p v-if="debug">{{reason}}</p>\n        <table v-if="debug" class="table table-bordered">\n          <tr>\n            <th>Src</th>\n            <th>Scores</th>\n          </tr>\n          <calc-log-item v-for="(value,key) in calclog" v-bind:colour=key v-bind:scores=value></calc-log-item>\n        </table>\n      </div>                      \n    </div>  \n  ',props:["fileurl","title","author","reason","year","institution","institutionURL","calclog","_id","debug"],computed:{detailsLink(){return i.IMAGE_DETAILS.replace(":id",this._id)}},methods:{onPreviewRequest:function(t){document.querySelector(`[src="${this.fileurl}"]`);this.$emit("preview-requested",this._id)},onDetailsRequest:function(t){this.$router.push({path:`${this.detailsLink}`})}}},o="READY",r="SERVER_WAIT";Vue.component("img-card",s),Vue.component("inp-colour-item",{template:"<div class='flex-fill' :style='style'></div> ",computed:{style(){return"background-color: "+this.colour}},props:["colour"]});var l={data:function(){return{inputColours:[],imgList:[],state:o,debug:!1,showQuestion:!0}},computed:{isListReady(){return this.state!=r}},template:'\n  <div>\n  <nav id="navbar" class="navbar navbar-expand-lg navbar-light bg-light">\n  <button class="navbar-toggler border-0 p-0" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01"\n    aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">\n    <span class="navbar-toggler-icon"></span>\n  </button>\n  <div class="collapse navbar-collapse" id="navbarTogglerDemo01">\n    <a class="navbar-brand" href="/">Artific</a>\n    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">\n      <li class="nav-item active">\n        <a class="nav-link" href="index.html">Home</a>\n      </li>\n      <li class="nav-item">\n        <a class="nav-link" href="about.html">About</a>\n      </li>\n      <li class="nav-item">\n        <a class="nav-link" href="museum.html">For museums</a>\n      </li>\n      <li class="nav-item">\n        <a class="nav-link" href="impressum.html">Legal Disclosure</a>\n      </li>\n    </ul>\n  </div>\n  <span class="navbar-text">\nChoose an artwork\n  </span>\n\n</nav>\n    <div class="flex-row">\n      <div class="d-flex w-100 colorsnav sticky-top">      \n        <inp-colour-item\n            v-for="colour in inputColours"\n            v-bind:colour="colour"\n          ></inp-colour-item>\n      </div>\n    \n      <div class="card-columns" v-if="isListReady">\n        <img-card\n          v-for="img in imgList"\n          \n          :calclog="img.calclog"\n          :fileurl="img.fileURL"\n          :title="img.title"\n          :author="img.author"\n          :reason="img.reason"\n          :_id="img._id"\n          :year="img.year"\n          :institution="img.institution"\n          :institutionURL="img.institutionURL"\n          :debug="debug"\n          @preview-requested="onPreviewRequest"\n        ></img-card>\n        <div v-if="showQuestion" class="card text-center">\n          <div class="card-body">\n            <span class="h1">\n            <i class="far fa-meh"></i>\n            </span>\n            <p>\n              Still haven\'t found what you\'re looking for?\n            </p>\n            <div class="button-container">\n              <button type="button" class="btn custom-action" v-on:click="goToQuestion"><i class="fas fa-pencil-alt"></i> Answer some questions</button>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="container" v-else>\n        <div class="box box-1">\n          <span class="h5">\n            <i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>\n          </span>\n        </div>\n      </div>\n    </div>\n</div>\n  ',methods:{goBack:function(t){this.$router.go(-1)},onPreviewRequest:function(t){var e=this.imgList.find(e=>e._id==t);a.putPreviewImg(e),this.$router.push(i.PREVIEW)},goToQuestion:function(){var t=this.imgList.map(t=>t._id);a.putBlacklist(t),this.$router.push({path:i.QUESTION,query:this.$route.query})}},mounted:function(){this.$route.query.hasOwnProperty("m")&&"debug"==this.$route.query.m&&(this.debug=!0),this.inputColours=a.inputColours;var t=this;this.state=r,a.getImgList(this.inputColours,function(e,n){t.imgList=e,t.state=o}),this.showQuestion=a.areQuestionsLeft()}};const c="#ffffff",u=2,d=5,h="#ffffff",m=.2,v=1,g=15,p="#000000",b="left",f="right",w="14pt Helvetica";function y(t,e,n,a,i,s=1){var o={};if(o.frame={x:t*s,y:e*s,w:n*s,h:a*s},i==b)var r=t+n-a;else r=t;var l=e;if(o.colourSelector={x:r*s,y:l*s,w:a*s,h:a*s,centerX:(r+a/2)*s,centerY:(l+a/2)*s},i==b)var c=t+d;else c=t+d+a;var u=e+a/2;return o.text={x:c*s,y:u*s},o}class k{constructor(t,e,n,a,i,s){this.x=t||0,this.y=e||0,this.w=n||1,this.h=a||1,this.fill=i||"#AAAAAA",this.selectedXoffset=0,this.selectedYoffset=0,this.selected=!1,this.image=null,this.text=s.name||"Colour",this.swatch=s,this.orientation=f}setImage(t){this.image=t}draw(t,e=1){this.image?this.drawAsImage(t,e):this.drawAsShape(t,e)}drawAsShape(t,e=1){var n=y(this.x,this.y,this.w,this.h,this.orientation,e);!function(t,e,n=!1){n&&(t.shadowColor=h,t.shadowBlur=g),t.fillStyle=h,t.globalAlpha=m,t.fillRect(e.x,e.y,e.w,e.h),t.strokeStyle=c,t.lineWidth=u,t.stroke(),t.globalAlpha=v}(t,n.frame,this.selected),function(t,e,n){t.fillStyle=n,t.fillRect(e.x,e.y,e.w,e.h),t.strokeStyle=c,t.lineWidth=u,t.stroke()}(t,n.colourSelector,this.fill),function(t,e,n,a=p){t.shadowBlur=0,t.font=w,t.textBaseline="middle",t.fillStyle=p,t.fillText(n,e.x,e.y)}(t,n.text,this.text)}drawAsImage(t,e=1){t.drawImage(this.image,this.startMouseX*e,this.startMouseY*e,targetWidth*e,targetHeight*e)}contains(t,e){return this.x<=t&&this.x+this.w>=t&&this.y<=e&&this.y+this.h>=e}isSelected(){return this.selected}select(t,e){this.selectedXoffset=t-this.x,this.selectedYoffset=e-this.y,this.selected=!0}unselect(){this.selected=!1}moveAllowed(t,e,n,a){var i=y(this.x,this.y,this.w,this.h,this.orientation),s=i.frame.x-i.colourSelector.centerX;if(this.orientation==b)var o=n-i.frame.w+i.colourSelector.w/2;else o=n-i.colourSelector.w/2-d;var r=0-d-i.colourSelector.h/2,l=a-i.frame.h+d+i.colourSelector.h/2;return t>=s&&t<=o&&e>=r&&e<=l}move(t,e,n=null,a=null){var i=t-this.selectedXoffset,s=e-this.selectedYoffset,o=!0;n&&a&&(o=this.moveAllowed(i,s,n,a)),o&&(this.x=i,this.y=s)}setColourSelectorPos(t,e){t-this.w<0&&(this.orientation=f);var n=y(t,e,this.w,this.h,this.orientation).colourSelector;this.x=this.x-(n.centerX-this.x),this.y=this.y-(n.centerY-this.y)}setColour(t){this.fill=t,this.swatch.colour=t}getColourSelector(){var t=y(this.x,this.y,this.w,this.h,this.orientation);return{x:t.colourSelector.centerX,y:t.colourSelector.centerY}}}var C={MAIN:"Main",SECONDARY:"Secondary",CONTRAST:"Contrast"};function x(t,e=null){var n=t.getHex();return e||(e=n),{colour:n,population:t.getPopulation(),name:e}}function S(t,e){return parseInt(t.population)>parseInt(e.population)?-1:parseInt(t.population)<parseInt(e.population)?1:0}function I(t,e,n,a){var i=new Vibrant(t,a,n),s=i.swatches(),o=[];for(var r in s)if(s.hasOwnProperty(r)&&s[r]){var l=x(s[r],r);o.push(l)}var c={};if(c.prominent=function(t){var e={population:0},n={population:0},a=[];for(var i in t){var s=t[i];s.name.toLowerCase().includes("vibrant")?s.population>e.population&&(e=s):s.population>n.population&&(n=s)}return n.name=C.SECONDARY,e.name=C.CONTRAST,a.push(n),a.push(e),a}(o),e){var u=[],d=i._swatches.slice();for(var r in d){l=x(d[r]);u.push(l)}c.all=function(t,e){for(var n in t.sort(S),t){var a=t[n];for(var i in e)e[i].colour===a.colour&&(a.name=e[i].name)}return t}(u,o)}var h=c.all[0];return h.name=C.MAIN,c.prominent.push(h),c}var L={getProminentColours:function(t,e=5,n=64){return I(t,!1,e,n)},getAllColours:function(t,e=5,n=64){return I(t,!0,e,n)},getPaletteMap(t){var e={};for(var n in t)e[n]=t[n].colour;return e}};const A=150,P=40,M=5,T=100,R=1;function D(t){return"#"+(t[0]<<16|t[1]<<8|t[2]).toString(16)}class U{constructor(t,e,n=!1){this.canvas=t,this.context=t.getContext("2d"),this.shapes=[],this.selected=null,this.nearestColours=null,this.videoSource,n?(this.videoSource=e,this.initializeCanvas(e)):(this.backgroundImg=e,this.canvas.width=e.naturalWidth,this.canvas.height=e.naturalHeight)}initializeCanvas(t){this.canvas.width=t.clientWidth,this.canvas.height=t.clientHeight,this.backgroundImg=t,this.drawBackground()}unfreeze(){this.initializeCanvas(this.videoSource)}takeSnapshot(t){var e=this;this.takeImgFromVideo(function(){e.canvas.width=e.backgroundImg.naturalWidth,e.canvas.height=e.backgroundImg.naturalHeight,e.selected=null,e.shapes=[],e.drawBackground(),setTimeout(function(){var n=e.initalizePalettes();e.drawInteractiveObjects(),t(n)},100)})}initalizePalettes(){var t=L.getAllColours(this.canvas),e=t.prominent,n=t.all,a=L.getPaletteMap(n),i=this.findPixelPalette(e.map(t=>t.colour),a);for(var s in i){var o=i[s],r=e.find(t=>t.colour===s);o.pos&&this.addShape(o.pos.x,o.pos.y,s,r)}return t}takeImgFromVideo(t){const e=document.createElement("canvas");var n=this.videoSource;e.width=1*n.clientWidth,e.height=1*n.clientHeight,e.getContext("2d").drawImage(n,0,0,e.width,e.height);const a=new Image;var i=this;a.onload=function(){i.backgroundImg=a,t()},a.src=e.toDataURL()}findShape(t,e){for(var n in this.shapes){var a=this.shapes[n];if(a.contains(t,e))return a}return null}moveSelected(t,e){if(this.selected){this.selected.move(t,e,this.canvas.width,this.canvas.height);var n=this.selected.getColourSelector(),a=this.getPixelColour(n.x,n.y);this.selected.setColour(a)}}getShapeColours(){var t={},e=[];for(var n in this.shapes){var a=this.shapes[n].swatch;t[a.name]=a}return t[C.MAIN]&&e.push(t[C.MAIN].colour),t[C.SECONDARY]&&e.push(t[C.SECONDARY].colour),t[C.CONTRAST]&&e.push(t[C.CONTRAST].colour),e}selectShape(t,e){var n=this.findShape(t,e);this.selected&&this.selected.unselect(),n&&(this.selected=n,this.selected.select(t,e))}releaseShape(){this.selected&&this.selected.unselect(),this.selected=null}getScale(){var t=parseInt(getComputedStyle(this.canvas).getPropertyValue("width"));return this.canvas.width/t}addShape(t,e,n,a){var i=new k(t,e,A,P,n,a);i.setColourSelectorPos(t,e),this.shapes.push(i)}clear(){this.context.clearRect(0,0,this.width,this.height)}drawBackground(){this.backgroundImg&&this.context.drawImage(this.backgroundImg,0,0)}drawInteractiveObjects(){for(var t in this.shapes)this.shapes[t].isSelected()||this.shapes[t].draw(this.context);this.selected&&this.selected.draw(this.context)}draw(){this.clear(),this.drawBackground(),this.drawInteractiveObjects()}getMouse(t){var e=this.getScale();return{x:parseInt(t.offsetX)*e,y:parseInt(t.offsetY)*e}}getTouch(t){var e=t.touches[0],n=this.getScale(),a=function(t){var e=0,n=0;if(t.offsetParent){do{e+=t.offsetLeft,n+=t.offsetTop}while(t=t.offsetParent);return{x:e,y:n}}}(this.canvas);if(e)var i={x:(e.pageX-a.x)*n,y:(e.pageY-a.y)*n};return i}getPos(t){return t.type.includes("mouse")?this.getMouse(t):t.type.includes("touch")?this.getTouch(t):void 0}getPixelColour(t,e){return D(this.context.getImageData(t,e,1,1).data)}getPixelNearest(t,e,n){null==this.nearestColours&&(this.nearestColours=nearestColor.from(n));var a=D(this.context.getImageData(t,e,1,1).data);return this.nearestColours(a).value}shapeWithinBoundaries(t,e){var n=this.canvas.width,a=this.canvas.height;return t-A>0&&e-P/2>0&&t+A/4<=n&&e+P/2<=a}findPixelPalette(t,e){var n=nearestColor.from(e),a=t.slice(),i=this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data,s=i.length,o={};for(var r in a)o[a[r]]={distance:T,pos:null};for(var l={},c=0;c<s;c+=4+R){var u=n(D([i[c],i[c+1],i[c+2]]));if(u&&(l.hasOwnProperty(u)?l[u]+=1:l[u]=1,a.includes(u.value))){var d=o[u.value].distance,h=Math.ceil(u.distance);if(h<d){var m={x:c/4%this.canvas.width,y:Math.floor(c/4/this.canvas.width)};if(this.shapeWithinBoundaries(m.x,m.y)&&(o[u.value]={distance:h,pos:m}),d<M){r=a.indexOf(u.value);a.splice(r,1)}}}if(0==a.length)break}return o}findPixelColour(t){for(var e=this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data,n=e.length,a=0;a<n;a+=4){if(D([e[a],e[a+1],e[a+2]])===t)return{x:a/4%this.canvas.width,y:Math.floor(a/4/this.canvas.width)}}return null}}var q={audio:!1,video:{facingMode:"environment"}};Vue.component("palette-item",{template:"<h3><span class='badge badge-primary' :style='style'>{{colour}} {{name}} ({{population}})</span></h3>",computed:{style(){return"background-color: "+this.colour}},props:["colour","population","name"]});var O={data:function(){return{interactiveCanvas:null,backgroundImg:null,paintingImg:null,previewHidden:!1,draggingMode:!1,startMouseX:0,startMouseY:0,debugStr:"",scale:1,markedColour:null,fullPalette:null,state:"video",uploadFallback:!1,allParsedColours:[],debug:!1}},computed:{isVideoHidden(){return"video"!=this.state},isPreviewHidden(){return"colour"!=this.state&&"processing"!=this.state},isProcessing(){return"processing"==this.state||"init"==this.state},isPreviewNotReady(){return"processing"==this.state||"video"==this.state||"init"==this.state},isUploadHidden(){return"manual"!=this.state},isPreviewReady(){return!this.isPreviewNotReady},style(){return"background-color: "+this.markedColour},snapshotBtLbl(){return"init"==this.state?"Starting webcam...":"processing"==this.state?"Crunching pixels...":"manual"==this.state?"Upload picture":"Take snapshot"}},template:'\n  <div class="container-fluid">\n  <nav id="navbar" class="navbar navbar-expand-lg navbar-light bg-light">\n  <button class="navbar-toggler border-0 p-0" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01"\n    aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">\n    <span class="navbar-toggler-icon"></span>\n  </button>\n  <div class="collapse navbar-collapse" id="navbarTogglerDemo01">\n    <a class="navbar-brand" href="/">Artific</a>\n    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">\n      <li class="nav-item active">\n        <a class="nav-link" href="index.html">Home</a>\n      </li>\n      <li class="nav-item">\n        <a class="nav-link" href="about.html">About</a>\n      </li>\n      <li class="nav-item">\n        <a class="nav-link" href="museum.html">For museums</a>\n      </li>\n      <li class="nav-item">\n        <a class="nav-link" href="impressum.html">Legal Disclosure</a>\n      </li>\n    </ul>\n  </div>\n  <span class="navbar-text">\nTake a photo\n  </span>\n  <div class="ml-auto  bd-highlight">\n  <div class="dropdown">\n    <button class="btn btn-secondary dropdown-toggle custom-switch" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n      <i class="fas fa-camera"></i> By photo</button>\n    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">\n      <a class="dropdown-item" href="app.html#/colour-picker"><i class="fas fa-palette"></i> By color</a>\n    </div>\n  </div>\n</div>\n</nav>\n    <p class="bg-light" v-if="debug">{{debugStr}} Dragging:{{draggingMode}}<span class=\'badge badge-primary\' :style=\'style\'>{{markedColour}}</span></p>\n    <div>\n        <video\n          id="video-el"\n          width="100%"\n          autoplay\n          playsinline\n          ref="video"\n          autoplay v-bind:hidden="isVideoHidden"\n        ></video>\n        <canvas width="100%" v-bind:hidden="isPreviewHidden" ref="photoCanvas" @mousedown="onDown" @touchstart="onDown" @mousemove="onMove" @touchmove="onMove" @mouseup="onUp" @touchend="onUp" ></canvas>\n        \n    </div>\n    <div class="container">\n      <div class="box box-1 alert alert-warning" v-bind:hidden="isUploadHidden">\n         <p>\n            Unfortunately we can’t access your camera. But don’t worry, you can\n            still select colors manually.\n          </p>\n          <button type="button" v-on:click="manualMode" class="btn custom-standard">Select colours manually</button>\n      </div>\n      <div class="box box-5 fixed-bottom">\n        <div class="mt-auto w-100 btn-group" role="group">\n          <button id="snapshot-btn" type="button" class="btn custom-standard btn-block" v-on:click="onTakeSnapshot" v-bind:hidden="isPreviewReady" :disabled="isProcessing">\n            <span v-if="isProcessing">\n              <i class="fa fa-spinner fa-spin fa-fw"></i> {{snapshotBtLbl}}\n            </span>\n            <span v-else>\n              <i class="fas fa-camera"></i> {{snapshotBtLbl}}\n            </span>\n          </button>\n    \n          <button id="find-art-btn" type="button" class="btn custom-action btn-block" v-on:click="onCommitColours" v-bind:hidden="isPreviewNotReady" :disabled="isProcessing"><i class="far fa-check-circle"></i> Find your art</button>\n          <button id="videoplay-btn" type="button" class="btn custom-standard btn-block" v-on:click="onRetakeSnapshot" v-bind:hidden="isPreviewNotReady" :disabled="isProcessing"><i class="fas fa-camera"></i> Retake photo</button>\n          </button>\n        </div>\n      </div>\n    </div>\n       <palette-item\n            v-for="swatch in allParsedColours"\n            v-bind:colour="swatch.colour"\n            v-bind:population="swatch.population"\n            v-bind:name="swatch.name"\n    ></palette-item>\n  </div>    \n \n    ',methods:{onDblClick:function(t){},onMove:function(t){if(this.interactiveCanvas){var e=this.interactiveCanvas.getPos(t);if(this.draggingMode&&this.interactiveCanvas.selected)this.interactiveCanvas.clear(),this.interactiveCanvas.drawBackground(),this.interactiveCanvas.moveSelected(e.x,e.y),this.interactiveCanvas.drawInteractiveObjects();else{var n=this.interactiveCanvas.getPixelColour(e.x,e.y);this.markedColour=n}}t.preventDefault()},onUp:function(t){if(this.draggingMode=!1,this.interactiveCanvas){this.interactiveCanvas.getPos(t);this.interactiveCanvas.releaseShape()}},onDown:function(t){if(this.draggingMode=!0,this.interactiveCanvas){var e=this.interactiveCanvas.getPos(t);this.interactiveCanvas.selectShape(e.x,e.y),this.interactiveCanvas.draw()}},onRetakeSnapshot:function(t){this.allParsedColours=[],this.interactiveCanvas.unfreeze(),this.uploadFallback?this.state="manual":this.state="video"},onTakeSnapshot:function(t){var e=this.$refs.video;this.debugStr=`client: ${e.clientWidth}/${e.clientHeight} video:${e.videoWidth}/${e.videoHeight}`,this.state="processing";var n=this;this.interactiveCanvas.takeSnapshot(function(t){n.state="colour",n.debug&&(n.allParsedColours=t.all)})},onCommitColours:function(t){var e=this.interactiveCanvas.getShapeColours();a.putInputColours(e),this.$router.push({path:i.RESULT_LIST,query:this.$route.query})},stopVideo:function(){var t=this.$refs.video;t.pause(),"srcObject"in t?t.srcObject&&t.srcObject.getTracks()[0].stop():t.src.stop()},initCanvas:function(t,e=!1){this.$refs.photoCanvas&&(this.interactiveCanvas=new U(this.$refs.photoCanvas,t,e))},manualMode:function(t){this.isUploadHidden&&this.stopVideo(),this.$router.push(i.COLOUR_PICKER_INPUT)},goBack:function(t){this.$router.go(-1)}},mounted:function(){this.$route.query.hasOwnProperty("m")&&"debug"==this.$route.query.m&&(this.debug=!0);var t=this.$refs.video;this.state="init";var e=this;navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(q).then(n=>{"srcObject"in t?t.srcObject=n:t.src=window.URL.createObjectURL(n),t.play(),this.state="video",setTimeout(function(){e.initCanvas(t,!0)},300)}).catch(function(t){e.uploadFallback=!0,e.state="manual"}):e.state="manual"},beforeRouteLeave:function(t,e,n){this.stopVideo(),n()}};var E={template:'\n<div class="container-fluid">\n<nav id="navbar" class="navbar navbar-expand-lg navbar-light bg-light">\n<button class="navbar-toggler border-0 p-0" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01"\n  aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">\n  <span class="navbar-toggler-icon"></span>\n</button>\n<div class="collapse navbar-collapse" id="navbarTogglerDemo01">\n  <a class="navbar-brand" href="/">Artific</a>\n  <ul class="navbar-nav mr-auto mt-2 mt-lg-0">\n    <li class="nav-item active">\n      <a class="nav-link" href="index.html">Home</a>\n    </li>\n    <li class="nav-item">\n      <a class="nav-link" href="about.html">About</a>\n    </li>\n    <li class="nav-item">\n      <a class="nav-link" href="museum.html">For museums</a>\n    </li>\n    <li class="nav-item">\n      <a class="nav-link" href="impressum.html">Legal Disclosure</a>\n    </li>\n  </ul>\n</div>\n<span class="navbar-text">\nChoose your colours\n</span>\n<div class="ml-auto  bd-highlight">\n<div class="dropdown">\n  <button class="btn btn-secondary dropdown-toggle custom-switch" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n    <i class="fas fa-palete"></i>  By color</button>\n  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">\n    <a class="dropdown-item" href="app.html#/photo-input"><i class="fas fa-camera"></i> By camera</a>\n  </div>\n</div>\n</div>\n</nav>\n  <div class="container">\n    <div class="box box-1">\n      <div class="btn-group mx-4" role="group" aria-label="Basic example">\n        <button\n          type="button"\n          class="btn btn-outline-light btn-lg w-25 mb-3"\n          v-on:click="selectMainColour"\n          :style="mainColourBg"\n        ></button>\n        <button\n          type="button"\n          class="btn btn-outline-light btn-lg w-75 p-3 mb-3"\n          v-on:click="selectMainColour"\n        >\n          {{mainBtLabel}}\n        </button>\n      </div>\n\n      <div class="btn-group mx-4 mb-3" role="group" aria-label="Basic example">\n        <button\n          type="button"\n          class="btn btn-outline-light btn-lg w-25 mb-3"\n          v-on:click="selectSecColour"\n          :style="secColourBg"\n        ></button>\n        <button\n          type="button"\n          class="btn btn-outline-light btn-lg w-75 p-3 mb-3"\n          v-on:click="selectSecColour"\n        >\n          {{secBtLabel}}\n        </button>\n      </div>\n\n      <div class="btn-group mx-4 mb-3" role="group" aria-label="Basic example">\n        <button\n          type="button"\n          class="btn btn-outline-light btn-lg w-25 mb-3"\n          v-on:click="selectContrastColour"\n          :style="contrastColourBg"\n        ></button>\n        <button\n          type="button"\n          class="btn btn-outline-light btn-lg w-75 p-3 mb-3"\n          v-on:click="selectContrastColour"\n        >\n          {{contrastBtLabel}}\n        </button>\n      </div>\n\n      <div class="box box-2">\n        <div class="mt-auto mt-md-0 fixed-bottom">\n          <button type="button" class="btn custom-standard btn-block" :disabled="isCommitDisabled" v-on:click="onCommitColours">\n            Find your art\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <div class="modal fade bd-example-modal-sm" id="colourPickModal" tabindex="-1" role="dialog">\n      <div class="modal-dialog modal-dialog-centered" role="document">\n        <div class="modal-content">\n          <div class="modal-header border-0">\n            <h5 class="modal-title">Choose a colour</h5>\n            <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n              <span aria-hidden="true">&times;</span>\n            </button>\n          </div>\n          <div class="modal-body mx-auto">\n            <div id="colour-pick" class="inl-bl w-100"></div>\n          </div>\n          <div class="modal-footer border-0">\n            \n            <button type="button" class="btn custom-standard btn-block" v-on:click="saveSelection">Save color</button>\n          </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n    ',data:function(){return{colours:[null,null,null],selectedColour:0}},computed:{mainColourBg(){return"background-color: "+this.colours[0]},secColourBg(){return"background-color: "+this.colours[1]},contrastColourBg(){return"background-color: "+this.colours[2]},mainBtLabel(){return this.colours[0]?this.colours[0].toUpperCase():"Set main colour"},secBtLabel(){return this.colours[1]?this.colours[1].toUpperCase():"Set secondary colour"},contrastBtLabel(){return this.colours[2]?this.colours[2].toUpperCase():"Set contrast colour"},isCommitDisabled(){return!(this.colours[0]||this.colours[1]||this.colours[2])}},methods:{selectMainColour:function(t){this.selectColour(0),this.showModal()},selectSecColour:function(t){this.selectColour(1),this.showModal()},selectContrastColour:function(t){this.selectColour(2),this.showModal()},saveSelection:function(t){var e=$("#colour-pick").colorpicker("getValue",null);this.$set(this.colours,this.selectedColour,e),this.hideModal()},showModal(){$("#colourPickModal").modal("show")},hideModal(){$("#colourPickModal").modal("hide")},selectColour(t){this.selectedColour=t;var e=this.colours[t];e&&$("#colour-pick").colorpicker("setValue",e)},onCommitColours:function(t){var e=this.getManualColours();a.putInputColours(e),console.log(e),this.$router.push({path:i.RESULT_LIST,query:this.$route.query})},getManualColours:function(){var t=this.colours[0]||"",e=this.colours[1]||"",n=this.colours[2]||"",a=[];return t.startsWith("#")&&a.push(t),e.startsWith("#")&&a.push(e),n.startsWith("#")&&a.push(n),a},photoMode:function(t){this.$router.push(i.PHOTO_INPUT)},goBack:function(t){this.$router.go(-1)}},mounted:function(){$(function(){$("#colour-pick").colorpicker({color:"#ffaa00",container:!0,inline:!0,customClass:"colorpicker-2x",sliders:{saturation:{maxLeft:200,maxTop:200},hue:{maxTop:200},alpha:{maxTop:200}}})});for(var t=a.inputColours,e=t.length>3?3:t.length,n=0;n<e;n++)this.$set(this.colours,n,t[n])}},B={scale:function(t,e){this.scalePlane("#artwork",t),e&&this.setMat("#artwork"),this.adjustFrame(e),this.adjustLockIndicator()},scalePlane:function(t,e){var n=document.querySelector(t),a=n.getAttribute("geometry"),i=a.width/a.height;a.height+=e,a.width+=e*i,n.setAttribute("geometry",a)},setMat:function(t){var e=document.querySelector(t),n=document.querySelector("#mat"),a=e.getAttribute("geometry"),i=e.getAttribute("position"),s=.2*a.width,o=n.getAttribute("geometry");o.width=a.width+s,o.height=a.height+s,n.setAttribute("geometry",o);var r=n.getAttribute("position");r.x=i.x,r.y=i.y,r.z=i.z-.01,n.setAttribute("position",r)},adjustFrame:function(t){if(t)var e=document.querySelector("#mat");else e=document.querySelector("#artwork");var n=e.getAttribute("geometry"),a=e.getAttribute("position");var i=.1*n.width,s=.05*n.width,o=a.x-n.width/2,r=a.x+n.width/2,l=a.y+n.height/2,c=a.y-n.height/2,u={x:o-s/2,y:a.y,z:a.z+.05,d:i,h:n.height,w:s},d={x:r+s/2,y:a.y,z:a.z+.05,d:i,h:n.height,w:s},h={x:a.x,y:l+s/2,z:a.z+.05,d:i,h:s,w:n.width+2*s},m={x:a.x,y:c-s/2,z:a.z+.05,d:i,h:s,w:n.width+2*s};this.setFrame("#left-frame",u),this.setFrame("#top-frame",h),this.setFrame("#bottom-frame",m),this.setFrame("#right-frame",d)},setFrame:function(t,e){var n=document.querySelector(t),a=n.getAttribute("geometry"),i=n.getAttribute("position");a.width=e.w,a.height=e.h,a.depth=e.d,i.x=e.x,i.y=e.y,i.z=e.z,n.setAttribute("geometry",a),n.setAttribute("position",i)},adjustImageDimensions:function(t){var e=document.querySelector("#artwork"),n=e.getAttribute("src"),a=document.querySelector(n),i=a.naturalWidth/a.naturalHeight,s=e.getAttribute("geometry");s.width=1*i,s.height=1,e.setAttribute("geometry",s),t&&this.setMat("#artwork"),this.adjustFrame(t),this.adjustLockIndicator()},resetLockIndicatorOpacity(){var t=document.querySelector("#lockIndicator"),e=t.getAttribute("material");e.opacity=.7,t.setAttribute("material",e)},adjustLockIndicator(){var t=document.querySelector("#top-frame"),e=t.getAttribute("geometry"),n=t.getAttribute("position"),a=document.querySelector("#lockIndicator"),i=a.getAttribute("geometry"),s={x:n.x+e.width/2+i.width/2+0,y:n.y+e.height/2+i.height+0,z:n.z};a.setAttribute("position",s)},adjustPreviewImage:function(){var t=document.querySelector("#trigger"),e=t.getAttribute("src"),n=document.querySelector(e),a=n.naturalWidth/n.naturalHeight,i=t.getAttribute("geometry");i.width=i.width*a,i.height=i.height,t.setAttribute("geometry",i)},recenter:function(){var t=document.querySelector("#camera-controler"),e=document.querySelector("#framedArtwork"),n=t.getAttribute("rotation"),a=e.getAttribute("rotation");a.x=n.x,a.y=n.y,a.z=n.z,e.setAttribute("rotation",a)},moveCam:function(t,e){var n=document.querySelector("#artwork"),a=n.getAttribute("position");a.z+=t,n.setAttribute("position",a),e&&this.setMat("#artwork"),this.adjustFrame(e)},resetScene:function(){document.querySelector("a-scene").reload()},registerListener:function(t,e){AFRAME.components.hasOwnProperty(t)&&delete AFRAME.components[t],AFRAME.registerComponent(t,e)},getImageDimensions:function(){var t=document.querySelector("#artwork");if(t){var e=t.getAttribute("geometry"),n=t.getAttribute("position");return`Img Pos: ${n.x.toFixed(2)}/${n.y.toFixed(2)}/${n.z.toFixed(2)} Geom:${e.width.toFixed(2)}/${e.height.toFixed(2)}`}return""},getCamera:function(){var t=document.querySelector("#camera"),e=document.querySelector("#camera-controler");if(t&&e){var n=t.getAttribute("position"),a=t.getAttribute("rotation"),i=e.getAttribute("rotation");return`Cam Pos: ${n.x.toFixed(2)}/${n.y.toFixed(2)}/${n.z.toFixed(2)} Rot:${i.x.toFixed(2)}(${a.x.toFixed(2)})/${i.y.toFixed(2)}(${a.y.toFixed(2)})/${i.z.toFixed(2)}(${a.z.toFixed(2)})`}return""}},F=function(t,e,n){const a=document.createElement("canvas");a.width=1*t.clientWidth,a.height=1*t.clientHeight;var i=a.getContext("2d");i.drawImage(t,0,0,a.width,a.height),i.drawImage(e,0,0,a.width,a.height);const s=new Image;s.onload=function(){n(this)},s.src=a.toDataURL()};var _={audio:!1,video:{facingMode:"environment"}},H={data:function(){return{images:[],currentImage:null,renderMat:!0,state:o,debug:!1,debugStr:"",previewMode:"initial",attachAnimation:!1,headsetConnected:!1}},computed:{frameColour(){return this.currentImage&&this.currentImage.colours.prominent.DarkVibrant||"#fcf0d1"},matColour(){return this.currentImage,"#fcf0d1"},isImageLoaded(){return this.state!=r},noVideoAvailable(){return"no video"==this.state},displayOverlay(){return"video"==this.state||"scrshot"==this.state},matMaterial(){return"color:"+this.matColour},frameMaterial(){return"color:"+this.frameColour},artworkPosition:()=>"0 2 -4",cameraPosition:()=>"0 1.6 0",triggerPosition:()=>"0 2 -3.8 ",triggeLockPosition:()=>`0 2 ${.1-3.8} `,showTrigger(){return"placed"!=this.previewMode},showArtwork(){return"placed"==this.previewMode?"true":"false"},showLockIndicator(){if("placed"==this.previewMode||"replacing"==this.previewMode)return"true"},lockIndicatorIcon(){return"placed"==this.previewMode&&this.headsetConnected?"#srcLock":"placed"!=this.previewMode||this.headsetConnected?"replacing"==this.previewMode?"#srcUnlock":"#srcLock":"#srcUnlock"},buttonsDisabled(){return"video"!=this.state||"placed"!=this.previewMode},isProcessing(){return"init"==this.state||"scrshot"==this.state},snapshotBtLbl(){return"init"==this.state?"Starting webcam":"scrshot"==this.state?"Hold on...":"This is it!"}},template:'\n   <div class="container-fluid">\n   <nav id="navbar" class="navbar navbar-expand-lg navbar-light bg-light">\n   <button class="navbar-toggler border-0 p-0" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01"\n     aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">\n     <span class="navbar-toggler-icon"></span>\n   </button>\n   <div class="collapse navbar-collapse" id="navbarTogglerDemo01">\n     <a class="navbar-brand" href="/">Artific</a>\n     <ul class="navbar-nav mr-auto mt-2 mt-lg-0">\n       <li class="nav-item active">\n         <a class="nav-link" href="index.html">Home</a>\n       </li>\n       <li class="nav-item">\n         <a class="nav-link" href="about.html">About</a>\n       </li>\n       <li class="nav-item">\n         <a class="nav-link" href="museum.html">For museums</a>\n       </li>\n       <li class="nav-item">\n         <a class="nav-link" href="impressum.html">Legal Disclosure</a>\n       </li>\n     </ul>\n   </div>\n   <span class="navbar-text">\nPlace the image on your wall\n   </span>\n\n </nav>\n    <p class="bg-light" v-if="debug">{{debugStr}}</p>\n    \n    <div class="ar-container">\n      <div class="box box-1 alert alert-warning" v-if="noVideoAvailable">\n      <br>\n        <p>\n            Unfortunately we can’t access your camera. But don’t worry, you can\n            still download and / or share the selected artwork.\n        </p>\n        <button type="button" v-on:click="checkoutWithoutSreenshot" class="btn custom-standard">Go to checkout</button>\n      </div>\n      <video\n        id="video-el"\n        width="100%"\n        playsinline\n        autoplay\n        \n        ref="video"\n        \n      ></video>\n    \n      <a-scene ref="overlay" id="overlay" v-if="displayOverlay" embedded vr-mode-ui="enabled:false" scene-listener cursor="rayOrigin: mouse;fuse:false; fuseTimeout: 0"><a-assets>\n          <img id="srcImage1" :src="currentImage.fileURL" crossorigin="anonymous"/>\n          <img id="srcLock" src="/dist/img/lockedIcon.png" crossorigin="anonymous"/>\n          <img id="srcUnlock" src="/dist/img/unlockedIcon.png" crossorigin="anonymous"/>\n        </a-assets>\n        <a-entity id="camera-controler" look-controls="enabled:true;hmdEnabled:false;touchEnabled:false" wasd-controls>\n        \n          <a-entity\n            id="camera"\n            camera="active: true"\n            look-controls="enabled:false;hmdEnabled:false;touchEnabled:false"\n            :position="cameraPosition"\n            data-aframe-default-camera\n            \n          >\n          \n          </a-entity>\n           <a-image\n            v-if="showTrigger"\n            clickable-trigger\n            id="trigger"\n            src="#srcImage1"\n            npot="true"\n            width="1"\n            height="1"\n            image-listener\n            :position="triggerPosition"\n            material = "transparent:false;opacity:0.5"\n          ></a-image>\n          <a-image\n            v-if="showTrigger"\n            clickable-trigger\n            id="triggerLock"\n            src="#srcUnlock"\n            npot="true"\n            width="0.7"\n            height="0.7"\n            :position="triggeLockPosition"\n            material = "opacity:0.7"\n          ></a-image>\n\n        </a-entity>\n        <a-entity id="framedArtwork" :visible="showArtwork">\n          \n          <a-plane\n            v-if="renderMat"\n            id="mat"\n            width="1.8"\n            height="1.2"\n            position="0 1.5923205925486443 -2.89"\n            :material="matMaterial"\n          ></a-plane>\n          <a-entity\n            position="-0.8516078879934923 1.6162200397155804 -2.85"\n            geometry="depth:0.1;width:0.1"\n            :material="frameMaterial"\n            id="left-frame"\n          ></a-entity>\n          <a-entity\n            position="0 2.1203709574339804 -2.8511166046347225"\n            geometry="depth:0.1;height:0.1;width:1.8"\n            :material="frameMaterial"\n            id="top-frame"\n          ></a-entity>\n          <a-entity\n            position="0 1.126 -2.85"\n            geometry="depth:0.1;height:0.1;width:1.8"\n            :material="frameMaterial"\n            id="bottom-frame"\n          ></a-entity>\n          <a-entity\n            position="0.8441961799454462 1.585018086559569 -2.85"\n            geometry="depth:0.1;width:0.1"\n            :material="frameMaterial"\n            id="right-frame"\n          ></a-entity>\n          \n          <a-image\n            :visible="showLockIndicator"\n            geometry="primitive: plane"\n            id="lockIndicator"\n            :src="lockIndicatorIcon"\n            npot="true"\n            width="0.2"\n            height="0.2"\n            position="0 0 0 "\n            material = "opacity:0.7"\n            animation="property:material.opacity;delay:2000;dur:1500;startEvents:fade;to:0"\n          >\n          \n          \n          </a-image>\n          \n          \n\n          <a-image\n            id="artwork"\n            click-drag\n            src="#srcImage1"\n            clickable-trigger\n            npot="true"\n            width="1.6"\n            height="1"\n            :position="artworkPosition"\n            image-listener\n          ></a-image>\n        </a-entity>\n          <a-entity\n            id="lightDirect"\n            light="intensity:0.6;castShadow:true"\n            position="0 1 1"\n            rotation=""\n          >\n          </a-entity>\n          <a-entity id="lightAmbient" light="color:#BBB;type:ambient"></a-entity>\n      </a-scene>\n    </div>\n    <div class="container">\n      <div class="box box-5 fixed-bottom">\n        <div class="btn-group w-100 btn-group-justified btn-group-lg" role="group">\n          <button id="larger-btn" type="button" class="btn custom-standard mr-3 rounded-right" v-on:click="scaleDown" :disabled="buttonsDisabled"><i class="fas fa-minus-circle"></i></button>\n          <button id="screenshot-btn" type="button" class="btn btn-block custom-action rounded" v-on:click="goToCheckout" :disabled="buttonsDisabled">\n            <span v-if="isProcessing">\n              <i class="fa fa-spinner fa-spin fa-fw"></i> {{snapshotBtLbl}}\n            </span>\n            <span v-else>\n              <i class="fas fa-check"></i> {{snapshotBtLbl}}\n            </span>\n          </button>\n           <button id="smaller-btn" type="button" class="btn custom-standard ml-3 rounded-left" v-on:click="scaleUp" :disabled="buttonsDisabled"><i class="fas fa-plus-circle"></i> </button>\n        </div>\n      </div>\n    </div>\n  </div>\n  ',props:["appstate"],methods:{onBackToList:function(t){this.$router.go(-1)},changeImage:function(){B.adjustImageDimensions(this.renderMat)},recenter:function(){"placed"==this.previewMode?(this.previewMode="replacing",this.attachAnimation=!1,B.resetLockIndicatorOpacity()):(B.recenter(),this.previewMode="placed",document.querySelector("#lockIndicator").emit("fade"),this.dumpCanvasGeometry(),this.updateDebugStr(),this.attachAnimation=!0)},checkoutWithoutSreenshot:function(){a.putCheckoutImg(this.currentImage,null),this.$router.push(i.CHECKOUT)},goToCheckout:function(){this.state="scrshot";var t=this,e=this.$refs.video;e.pause(),setTimeout(function(){var n=document.querySelector("a-scene").components.screenshot.getCanvas("perspective");F(e,n,function(e){var n=e.src;a.putCheckoutImg(t.currentImage,n),t.state="video",t.$router.push(i.CHECKOUT)})},100)},scaleUp:function(){B.scale(.1,this.renderMat),this.updateDebugStr()},scaleDown:function(){B.scale(-.1,this.renderMat),this.updateDebugStr()},stepForward:function(){B.moveCam(-.5,this.renderMat),this.updateDebugStr()},stepBack:function(){B.moveCam(.5,this.renderMat),this.updateDebugStr()},dumpCanvasGeometry:function(){var t=document.querySelector("canvas.a-canvas");console.log(`CLIENT - w:${t.clientWidth} h:${t.clientHeight} ratio:${t.clientWidth/t.clientHeight}`),console.log(`CANVAS - w:${t.width} h:${t.height} ratio: ${t.width/t.height}`)},updateDebugStr:function(){this.debugStr=B.getImageDimensions()+" "+B.getCamera()},stopVideo:function(){var t=this.$refs.video;t.pause(),"srcObject"in t?t.srcObject.getTracks()[0].stop():t.src.stop()}},mounted(){this.state="init",this.$route.query.hasOwnProperty("m")&&"debug"==this.$route.query.m&&(this.debug=!0);var t=this;this.images=a.getPreviewImgList(),this.currentImage=this.images[0];var e=this.$refs.video;this.headsetConnected=AFRAME.utils.device.checkHeadsetConnected();AFRAME.utils.device.isMobile(),AFRAME.utils.device.isGearVR();this.previewMode="initial",B.registerListener("scene-listener",{init:function(){var t=this.el.sceneEl,n=e.offsetWidth,a=e.offsetHeight;t.width=n,t.height=a},update:function(){}}),B.registerListener("clickable-trigger",{init:function(){this.el.addEventListener("click",function(){t.recenter()})}}),B.registerListener("image-listener",{update:function(){var e=this.el,n=e.getAttribute("src");document.querySelector(n)&&("artwork"==e.id?(B.adjustImageDimensions(t.renderMat),t.updateDebugStr()):B.adjustPreviewImage())},init:function(){}}),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(_).then(n=>{"srcObject"in e?e.srcObject=n:e.src=window.URL.createObjectURL(n),e.play(),e.onplaying=function(){t.state="video"}}).catch(function(e){t.state="no video"}):this.state},beforeRouteLeave:function(t,e,n){"no video"!=this.state&&this.stopVideo(),n()}},j={data:function(){return{image:{fileURL:"",title:"",author:"",filename:"",shopURL:""},screenshot:null,sharingSupported:!1,arGotoEnable:!1,hideLink:!0}},computed:{isScreenshot(){return!!this.screenshot},shopEnabled(){return!!this.image.printURL},isImageLoaded(){return this.state!=r},downloadURL(){return`https://storage.luckycloud.de/d/9b4540c37b684629ab09/files/?p=/big/${this.image.filename}&dl=1`}},template:'\n    <div class="container-fluid">\n    <nav id="navbar" class="navbar navbar-expand-lg navbar-light bg-light">\n    <button class="navbar-toggler border-0 p-0" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01"\n      aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">\n      <span class="navbar-toggler-icon"></span>\n    </button>\n    <div class="collapse navbar-collapse" id="navbarTogglerDemo01">\n      <a class="navbar-brand" href="/">Artific</a>\n      <ul class="navbar-nav mr-auto mt-2 mt-lg-0">\n        <li class="nav-item active">\n          <a class="nav-link" href="index.html">Home</a>\n        </li>\n        <li class="nav-item">\n          <a class="nav-link" href="about.html">About</a>\n        </li>\n        <li class="nav-item">\n          <a class="nav-link" href="museum.html">For museums</a>\n        </li>\n        <li class="nav-item">\n          <a class="nav-link" href="impressum.html">Impressum</a>\n        </li>\n      </ul>\n    </div>\n    <span class="navbar-text">\nGreat choice!\n    </span>\n \n  </nav>\n        <div id="imageDetailsContainer" class="container">\n            <div class="card card-checkout" v-if="isImageLoaded">\n              <div class="wrapper-checkout">\n                <img v-if="isScreenshot" class="card-img-top img-fluid" :src="screenshot" alt="Card image cap">\n                <img v-else class="card-img-top img-fluid" :src="image.fileURL" alt="Card image cap">\n              </div>              \n              <div class="card-body">\n                    <h4 class="card-title">{{image.title}}</h4>\n                    <p class="card-text">\n                        {{image.author}}\n                        <br/>{{image.year}}<br/>\n                        <i class="fas fa-university"></i><a :href="image.institutionURL" target="_blank"> {{image.institution}}</a>\n                    </p>\n                    <div class="button-container">\n                        <a v-if="isScreenshot" :href="screenshot" class="btn custom-standard btn-block" role="button" aria-disabled="true" download><i class="far fa-save"></i> Save screenshot</a>\n                        <a :href="downloadURL" class="btn custom-standard btn-block" role="button" aria-disabled="true" download><i class="fa fa-arrow-circle-down"></i> Download artwork</a>\n                        <button v-if="sharingSupported" v-on:click="share" class="btn custom-standard btn-block" role="button" aria-disabled="true"><i class="fas fa-share-alt"></i> Share</button>\n                        <span v-else>\n                          <button v-on:click="shareURL" class="btn custom-standard btn-block" role="button" aria-disabled="true"><i class="fas fa-share-alt"></i> Share</button>\n                          \n                         \n                          <div :hidden="hideLink" class="input-group mb-3">\n                            <div class="input-group"> \n                              \n                              <input type="text" class="form-control h-100" ref="shareLink" readonly/>\n                              <span class="input-group-btn">\n                                  <button class="btn btn-outline-secondary" type="button" v-on:click="copyToClipboard"><i class="far fa-copy"></i></button>\n                              </span>\n                            </div>\n                           \n                          </div>\n                        </span>\n                        <a v-if="shopEnabled" :href="image.printURL" target="_blank" class="btn custom-action btn-block" role="button" aria-disabled="true"><i class="fa fa-shopping-cart"></i> Order print</a>\n                        <button v-if="arGotoEnable" class="btn custom-action btn-block" role="button" aria-disabled="true" v-on:click="onTryIt"><i class="far fa-image"></i> See it on your wall</button>\n                        <hr p-3>\n                        <h5>Do you want to try again?</h5>\n                        <a href="/" class="btn custom-action btn-block pt-2" role="button" aria-disabled="true"><i class="fa fa-undo-alt"></i> Find more art</a>\n                        \n                    </div>\n                </div>\n            </div>\n            <div v-else>\n              <i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>\n              <span class="sr-only">Loading...</span>\n            </div>\n            <div id="copiedToClipboard" class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-hidden="true">\n              <div class="modal-dialog modal-sm modal-dialog-centered">\n                <div class="modal-content">\n                  <div class="modal-header">\n                    <h5 class="modal-title">Link copied to clipboard</h5>\n                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">&times;</span>\n                      </button>\n                    </div>\n                </div>\n                \n              </div>\n            </div>\n        </div>\n    </div>\n  ',methods:{getImagePermalink(){return`${window.location.protocol}//${window.location.host}${window.location.pathname.split("#")[0]}#${i.IMAGE_DETAILS.replace(":id",this.image._id)}`},copyToClipboard:function(){this.$refs.shareLink.select(),document.execCommand("copy"),$("#copiedToClipboard").modal("show")},shareURL:function(){var t=this.getImagePermalink();this.hideLink=!1,this.$refs.shareLink.value=t},onTryIt:function(t){a.putPreviewImg(this.image),this.$router.push(i.PREVIEW)},share:function(){var t=this.getImagePermalink();navigator.share({title:"Artific.app Recommendation",text:"This is the artwork https://www.artific.app recommended me, what do you think? #artificapp",url:t})}},mounted(){var t=this.$route.params.id;if(t){this.state=r;var e=this;a.getImgDetails(t,function(t){t&&(e.image=t),e.state=o,e.arGotoEnable=!0})}else{var n=a.getCheckoutImg();n&&(this.image=n.image,this.screenshot=n.screenshot),navigator.share&&(this.sharingSupported=!0)}}},V={data:function(){return{question:{question:"",answers:[]},state:o}},computed:{},template:'\n   <div class="container-fluid">\n   <nav id="navbar" class="navbar navbar-expand-lg navbar-light bg-light">\n   <button class="navbar-toggler border-0 p-0" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01"\n     aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">\n     <span class="navbar-toggler-icon"></span>\n   </button>\n   <div class="collapse navbar-collapse" id="navbarTogglerDemo01">\n     <a class="navbar-brand" href="/">Artific</a>\n     <ul class="navbar-nav mr-auto mt-2 mt-lg-0">\n       <li class="nav-item active">\n         <a class="nav-link" href="index.html">Home</a>\n       </li>\n       <li class="nav-item">\n         <a class="nav-link" href="about.html">About</a>\n       </li>\n       <li class="nav-item">\n         <a class="nav-link" href="museum.html">For museums</a>\n       </li>\n       <li class="nav-item">\n         <a class="nav-link" href="impressum.html">Legal Disclosure</a>\n       </li>\n     </ul>\n   </div>\n   <span class="navbar-text">\nAnswer the question\n   </span>\n\n </nav>\n    <div class="container">\n        <div class="box box-1">\n          <h5 class="question">{{question.question}}</h5>\n        </div>\n        <div class="text-light box box-2">\n          <div class="mt-auto mt-md-0">\n            <button v-for="answer in question.answers" v-on:click="onAnswer" role="button" class="btn custom-standard btn-block rounded-0">{{answer}}</button> \n          </div>\n        </div>\n    </div>\n  </div>\n  ',methods:{onAnswer:function(t){var e=(t.target||t.srcElement).textContent;a.putAnswer(this.question.id,e),this.$router.push({path:i.RESULT_LIST,query:this.$route.query})}},mounted(){this.state=r;var t=this;a.getRandomQuestion(function(e){e&&(t.question=e),t.state=o})}};const z=[{path:i.PHOTO_INPUT,component:O},{path:i.RESULT_LIST,component:l},{path:i.COLOUR_PICKER_INPUT,component:E},{path:i.IMAGE_DETAILS,component:j},{path:i.PREVIEW,component:H},{path:i.CHECKOUT,component:j},{path:i.QUESTION,component:V}],N=new VueRouter({routes:z});new Vue({router:N}).$mount("#vue-app")}]);